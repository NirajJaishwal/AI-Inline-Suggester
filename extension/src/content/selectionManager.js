// Purpose:
// Extract and replace only the correct text range.

// Handles:

// Selection API

// Range offsets

// Cursor restoration

// Why it matters:

// One bad replace = broken editor + rage uninstall.